{
	"name": "ldIPT127RPMComplexLoad_PX_FF_Rej",
	"properties": {
		"folder": {
			"name": "12-PriceUpdatesRPM"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AB_TSPCT_STG_PMOTN_CMPLX_THLD_T_127_Temp",
						"type": "DatasetReference"
					},
					"name": "TSPCTTemp"
				},
				{
					"dataset": {
						"referenceName": "AB_ldIPT127RPMComplexLoad_PX_FF_ComplexRej2",
						"type": "DatasetReference"
					},
					"name": "FFComplexRej"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AB_ldIPT127RPMComplexLoad_PX_FF_ComplexRej2",
						"type": "DatasetReference"
					},
					"name": "FFComplexRej1"
				}
			],
			"transformations": [
				{
					"name": "filter1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "union1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     PROMO_ID as integer (0),",
				"     PROMO_NAME as string (toString(null())),",
				"     COMP_DISPLAY_ID as string (toString(null())),",
				"     PROMO_COMP_ID as integer (0),",
				"     PROMO_COMP_DETAIL_ID as integer (0),",
				"     PROMO_COMP_DETAIL_DISPLAY_ID as string (toString(null())),",
				"     THRESHOLD_ID as integer (0),",
				"     THRESHOLD_DISPLAY_ID as string,",
				"     MERCH_TYPE as integer (0),",
				"     DIVISION as integer (0),",
				"     GROUP_NO as integer (0),",
				"     DEPT as integer (0),",
				"     CLASS as integer (0),",
				"     SUBCLASS as integer (0),",
				"     DIFF_ID as string (toString(null())),",
				"     ITEM as string (toString(null())),",
				"     ATTRIBUTE_1 as string (toString(null())),",
				"     ATTRIBUTE_2 as string (toString(null())),",
				"     ATTRIBUTE_3 as string (toString(null())),",
				"     ZONE_NODE_TYPE as integer (0),",
				"     ZONE_ID as integer (0),",
				"     LOCATION as integer (0),",
				"     APPLY_TO_CODE as integer (0),",
				"     START_DATE as string (toString(null())),",
				"     END_DATE as string (toString(null())),",
				"     IGNORE_CONSTRAINTS as integer (0),",
				"     THRESHOLD_NAME as string (toString(null())),",
				"     CURRENCY_CODE as string (toString(null())),",
				"     QUALIFICATION_TYPE as integer (0),",
				"     THRESHOLD_TYPE as integer (0),",
				"     THRESHOLD_AMOUNT as decimal(10,0) (toDecimal(0)),",
				"     THRESHOLD_CURRENCY as string (toString(null())),",
				"     THRESHOLD_QUANTITY as decimal(10,0) (toDecimal(0)),",
				"     CHANGE_TYPE as integer (0),",
				"     CHANGE_AMOUNT as decimal(10,0) (toDecimal(0)),",
				"     CHANGE_CURRENCY as string (toString(null())),",
				"     CHANGE_PERCENT as decimal(10,0) (toDecimal(0)),",
				"     CHANGE_UOM as string (toString(null())),",
				"     AUTO_APPROVE_IND as integer (0),",
				"     PROCESS_ID as integer (0),",
				"     STATUS as string (toString(null())),",
				"     ERR_MSG_TXT as string (toString(null()))",
				"}",
				"source(output(",
				"          PROMO_ID as integer,",
				"          PROMO_NAME as string,",
				"          COMP_DISPLAY_ID as string,",
				"          PROMO_COMP_ID as integer,",
				"          PROMO_COMP_DETAIL_ID as integer,",
				"          PROMO_COMP_DETAIL_DISPLAY_ID as string,",
				"          THRESHOLD_ID as integer,",
				"          THRESHOLD_DISPLAY_ID as string,",
				"          MERCH_TYPE as integer,",
				"          DIVISION as integer,",
				"          GROUP_NO as integer,",
				"          DEPT as integer,",
				"          CLASS as integer,",
				"          SUBCLASS as integer,",
				"          DIFF_ID as string,",
				"          ITEM as string,",
				"          ATTRIBUTE_1 as string,",
				"          ATTRIBUTE_2 as string,",
				"          ATTRIBUTE_3 as string,",
				"          ZONE_NODE_TYPE as integer,",
				"          ZONE_ID as integer,",
				"          LOCATION as integer,",
				"          APPLY_TO_CODE as integer,",
				"          START_DATE as timestamp,",
				"          END_DATE as timestamp,",
				"          IGNORE_CONSTRAINTS as integer,",
				"          THRESHOLD_NAME as string,",
				"          CURRENCY_CODE as string,",
				"          QUALIFICATION_TYPE as integer,",
				"          THRESHOLD_TYPE as integer,",
				"          THRESHOLD_AMOUNT as decimal(10,0),",
				"          THRESHOLD_CURRENCY as string,",
				"          THRESHOLD_QUANTITY as decimal(10,0),",
				"          CHANGE_TYPE as integer,",
				"          CHANGE_AMOUNT as decimal(10,0),",
				"          CHANGE_CURRENCY as string,",
				"          CHANGE_PERCENT as decimal(10,0),",
				"          CHANGE_UOM as string,",
				"          AUTO_APPROVE_IND as integer,",
				"          PROCESS_ID as integer,",
				"          STATUS as string,",
				"          ERR_MSG_TXT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> TSPCTTemp",
				"source(output(",
				"          PROMO_ID as integer,",
				"          PROMO_NAME as string,",
				"          COMP_DISPLAY_ID as string,",
				"          PROMO_COMP_ID as integer,",
				"          PROMO_COMP_DETAIL_ID as integer,",
				"          PROMO_COMP_DETAIL_DISPLAY_ID as string,",
				"          THRESHOLD_ID as integer,",
				"          THRESHOLD_DISPLAY_ID as string,",
				"          MERCH_TYPE as integer,",
				"          DIVISION as integer,",
				"          GROUP_NO as integer,",
				"          DEPT as integer,",
				"          CLASS as integer,",
				"          SUBCLASS as integer,",
				"          DIFF_ID as string,",
				"          ITEM as string,",
				"          ATTRIBUTE_1 as string,",
				"          ATTRIBUTE_2 as string,",
				"          ATTRIBUTE_3 as string,",
				"          ZONE_NODE_TYPE as integer,",
				"          ZONE_ID as integer,",
				"          LOCATION as integer,",
				"          APPLY_TO_CODE as integer,",
				"          START_DATE as timestamp,",
				"          END_DATE as timestamp,",
				"          IGNORE_CONSTRAINTS as integer,",
				"          THRESHOLD_NAME as string,",
				"          CURRENCY_CODE as string,",
				"          QUALIFICATION_TYPE as integer,",
				"          THRESHOLD_TYPE as integer,",
				"          THRESHOLD_AMOUNT as decimal(10,0),",
				"          THRESHOLD_CURRENCY as string,",
				"          THRESHOLD_QUANTITY as decimal(10,0),",
				"          CHANGE_TYPE as integer,",
				"          CHANGE_AMOUNT as decimal(10,0),",
				"          CHANGE_CURRENCY as string,",
				"          CHANGE_PERCENT as decimal(10,0),",
				"          CHANGE_UOM as string,",
				"          AUTO_APPROVE_IND as integer,",
				"          PROCESS_ID as integer,",
				"          STATUS as string,",
				"          ERR_MSG_TXT as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> FFComplexRej",
				"TSPCTTemp filter(PROMO_ID == $PROMO_ID || isNull(PROMO_ID)  && \r",
				"PROMO_NAME == $PROMO_NAME || isNull(PROMO_NAME) && \r",
				"COMP_DISPLAY_ID == $COMP_DISPLAY_ID || isNull(COMP_DISPLAY_ID) && \r",
				"PROMO_COMP_ID ==$PROMO_COMP_ID || isNull(PROMO_COMP_ID) &&\r",
				"PROMO_COMP_DETAIL_ID == $PROMO_COMP_DETAIL_ID || isNull(PROMO_COMP_DETAIL_ID)  && \r",
				"PROMO_COMP_DETAIL_DISPLAY_ID == $PROMO_COMP_DETAIL_DISPLAY_ID || isNull(PROMO_COMP_DETAIL_DISPLAY_ID) && \r",
				"THRESHOLD_ID == $THRESHOLD_ID || isNull(THRESHOLD_ID) && \r",
				"THRESHOLD_DISPLAY_ID ==$THRESHOLD_DISPLAY_ID || isNull(THRESHOLD_DISPLAY_ID) &&\r",
				"MERCH_TYPE == $MERCH_TYPE || isNull(MERCH_TYPE)  && \r",
				"DIVISION == $DIVISION || isNull(DIVISION) && \r",
				"GROUP_NO == $GROUP_NO || isNull(GROUP_NO) && \r",
				"DEPT ==$DEPT || isNull(DEPT) &&\r",
				"CLASS == $CLASS || isNull(CLASS)  && \r",
				"SUBCLASS == $SUBCLASS || isNull(SUBCLASS) && \r",
				"DIFF_ID == $DIFF_ID || isNull(DIFF_ID) && \r",
				"ITEM ==$ITEM || isNull(ITEM) &&\r",
				"ATTRIBUTE_1 == $ATTRIBUTE_1 || isNull(ATTRIBUTE_1)  && \r",
				"ATTRIBUTE_2 == $ATTRIBUTE_2 || isNull(ATTRIBUTE_2) && \r",
				"ATTRIBUTE_3 == $ATTRIBUTE_3 || isNull(ATTRIBUTE_3) && \r",
				"ZONE_NODE_TYPE ==$ZONE_NODE_TYPE || isNull(ZONE_NODE_TYPE) &&\r",
				"ZONE_ID == $ZONE_ID || isNull(ZONE_ID)  && \r",
				"LOCATION == $LOCATION || isNull(LOCATION) && \r",
				"APPLY_TO_CODE == $APPLY_TO_CODE || isNull(APPLY_TO_CODE) && \r",
				"START_DATE == toTimestamp($START_DATE) || isNull(START_DATE) && \r",
				"END_DATE == toTimestamp($END_DATE) || isNull(END_DATE) && \r",
				"IGNORE_CONSTRAINTS == $IGNORE_CONSTRAINTS || isNull(IGNORE_CONSTRAINTS)&&\r",
				"THRESHOLD_NAME == $THRESHOLD_NAME || isNull(THRESHOLD_NAME)&&\r",
				"CURRENCY_CODE == $CURRENCY_CODE || isNull(CURRENCY_CODE)&&\r",
				"QUALIFICATION_TYPE == $QUALIFICATION_TYPE || isNull(QUALIFICATION_TYPE)&&\r",
				"THRESHOLD_TYPE == $THRESHOLD_TYPE || isNull(THRESHOLD_TYPE)&&\r",
				"THRESHOLD_AMOUNT == $THRESHOLD_AMOUNT || isNull(THRESHOLD_AMOUNT)&&\r",
				"THRESHOLD_CURRENCY == $THRESHOLD_CURRENCY || isNull(THRESHOLD_CURRENCY)&&\r",
				"THRESHOLD_QUANTITY == $THRESHOLD_QUANTITY || isNull(THRESHOLD_QUANTITY)&&\r",
				"CHANGE_TYPE == $CHANGE_TYPE || isNull(CHANGE_TYPE)&&\r",
				"CHANGE_AMOUNT == $CHANGE_AMOUNT || isNull(CHANGE_AMOUNT)&&\r",
				"CHANGE_CURRENCY == $CHANGE_CURRENCY || isNull(CHANGE_CURRENCY)&&\r",
				"CHANGE_PERCENT == $CHANGE_PERCENT || isNull(CHANGE_PERCENT)&&\r",
				"CHANGE_UOM == $CHANGE_UOM || isNull(CHANGE_UOM)&&\r",
				"AUTO_APPROVE_IND == $AUTO_APPROVE_IND || isNull(AUTO_APPROVE_IND)&&\r",
				"PROCESS_ID == $PROCESS_ID || isNull(PROCESS_ID)&&\r",
				"STATUS == $STATUS || isNull(STATUS)&&\r",
				"ERR_MSG_TXT == $ERR_MSG_TXT || isNull(ERR_MSG_TXT)) ~> filter1",
				"filter1 derive(DATE_TIME = currentDate()) ~> derivedColumn1",
				"derivedColumn1, FFComplexRej union(byName: true)~> union1",
				"union1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          PROMO_ID as string,",
				"          PROMO_NAME as string,",
				"          COMP_DISPLAY_ID as string,",
				"          PROMO_COMP_ID as string,",
				"          PROMO_COMP_DETAIL_ID as string,",
				"          PROMO_COMP_DETAIL_DISPLAY_ID as string,",
				"          THRESHOLD_ID as string,",
				"          THRESHOLD_DISPLAY_ID as string,",
				"          MERCH_TYPE as string,",
				"          DIVISION as string,",
				"          GROUP_NO as string,",
				"          DEPT as string,",
				"          CLASS as string,",
				"          SUBCLASS as string,",
				"          DIFF_ID as string,",
				"          ITEM as string,",
				"          ATTRIBUTE_1 as string,",
				"          ATTRIBUTE_2 as string,",
				"          ATTRIBUTE_3 as string,",
				"          ZONE_NODE_TYPE as string,",
				"          ZONE_ID as string,",
				"          LOCATION as string,",
				"          APPLY_TO_CODE as string,",
				"          START_DATE as string,",
				"          END_DATE as string,",
				"          IGNORE_CONSTRAINTS as string,",
				"          THRESHOLD_NAME as string,",
				"          CURRENCY_CODE as string,",
				"          QUALIFICATION_TYPE as string,",
				"          THRESHOLD_TYPE as string,",
				"          THRESHOLD_AMOUNT as string,",
				"          THRESHOLD_CURRENCY as string,",
				"          THRESHOLD_QUANTITY as string,",
				"          CHANGE_TYPE as string,",
				"          CHANGE_AMOUNT as string,",
				"          CHANGE_CURRENCY as string,",
				"          CHANGE_PERCENT as string,",
				"          CHANGE_UOM as string,",
				"          AUTO_APPROVE_IND as string,",
				"          PROCESS_ID as string,",
				"          STATUS as string,",
				"          ERR_MSG_TXT as string",
				"     ),",
				"     partitionFileNames:['ldIPT127RPMComplexLoad_PX.FF_ComplexRej.txt'],",
				"     umask: 0777,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> FFComplexRej1"
			]
		}
	}
}